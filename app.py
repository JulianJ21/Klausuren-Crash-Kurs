import streamlit as st
import random

# Set page config
st.set_page_config(page_title="Marketing Exam Prep", layout="wide")

# Emoji Icons
book = "üìò"
flashcard = "üÉè"
quiz = "‚ùì"
check = "‚úÖ"
cross = "‚ùå"
brain = "üß†"
chart = "üìä"
rocket = "üöÄ"
exam_icon = "üìù"

# App Title
st.title(f"{rocket} Marketing Exam Prep App")
st.markdown("**Your complete tool to master the Marketing exam** ‚Äì script, flashcards, quizzes, and past exams.")

# --- PROGRESS TRACKER SESSION STATE ---
if "correct" not in st.session_state:
    st.session_state.correct = 0
if "incorrect" not in st.session_state:
    st.session_state.incorrect = 0

def reset_progress():
    st.session_state.correct = 0
    st.session_state.incorrect = 0

# --- FLASHCARD COMPONENT ---
def flashcard(prompt, answer, key):
    with st.expander(f"{flashcard} **{prompt}**", expanded=False):
        st.markdown(f"{brain} {answer}")

# --- QUIZ COMPONENT (Open Question) ---
def quiz_open(prompt, correct_answer, key):
    user_input = st.text_area(f"{quiz} {prompt}", key=key)
    if user_input:
        if user_input.strip().lower() in correct_answer.lower():
            st.success(f"{check} Correct! Model answer: {correct_answer}")
            st.session_state.correct += 1
        else:
            st.error(f"{cross} Not quite. Model answer: {correct_answer}")
            st.session_state.incorrect += 1

# --- MULTIPLE CHOICE QUIZ COMPONENT ---
def quiz_mc(prompt, options, correct_indices, key):
    selected = st.multiselect(f"{quiz} {prompt}", options, key=key)
    if set(selected) == {options[i] for i in correct_indices}:
        st.success(f"{check} Correct!")
        st.session_state.correct += 1
    else:
        st.error(f"{cross} Not quite.")
        st.session_state.incorrect += 1

# --- PROGRESS TRACKER DISPLAY ---
def show_progress():
    total = st.session_state.correct + st.session_state.incorrect
    if total > 0:
        st.markdown(f"{chart} **Progress:** {st.session_state.correct} correct / {total} total")
        st.progress(st.session_state.correct / total)

# --- SIDEBAR NAVIGATION ---
st.sidebar.title("üìÇ Navigation")
section = st.sidebar.radio(
    "Choose section",
    [
        "üè† Home",
        "üìò Script-Based Learning",
        "üìù Past Exam Training",
        "üìä Progress Tracker",
    ]
)

# --- HOME PAGE ---
if section == "üè† Home":
    st.header("Welcome!")
    st.write("""
    Use the sidebar to navigate between the script chapters, exam practice, and progress overview.
    
    Features:
    - Full coverage of the *Marketing Zusammenfassung SoSe23*
    - Flashcards, quizzes, open and MC questions
    - All past exams: SS23, SoSe23 (Mock), SS25
    - Simple ‚úÖ/‚ùå tracking
    """)
    if st.button("üîÑ Reset Progress"):
        reset_progress()
        st.success("Progress has been reset.")
        
        
# --- SCRIPT-BASED LEARNING SECTION ---
elif section == "üìò Script-Based Learning":
    st.header(f"{book} Full Script-Based Learning")

    chapter = st.selectbox("Choose Chapter", [
        "1. Grundlagen",
        "2. Konsumentenverhalten",
        "3. Organisationales Kaufverhalten",
        "4. Strategisches Marketing",
        "5. Digital Marketing",
        "6. Produktpolitik",
        "7. Preispolitik",
        "8. Kommunikationspolitik",
        "9. Vertriebspolitik",
        "10. Marktforschung",
        "11. Marktsegmentierung",
        "12. Kundenbeziehungsmanagement",
        "13. Markenf√ºhrung",
        "14. Innovationen & Produktentwicklung",
        "15. Pricing Methoden",
        "16. Preiselastizit√§t",
        "17. Kommunikationsmix",
        "18. Mediaplanung",
        "19. TKP & Reichweite",
        "20. Sch√§tzfunktionen",
        "21. Buying Center",
        "22. Erfahrungskurve",
        "23. Lebenszyklusmodell",
        "24. Ansoff Matrix & Wettbewerbsstrategien",
    ])

    # --- CHAPTER 1: Grundlagen ---
    if chapter == "1. Grundlagen":
        st.subheader("1. Grundlagen")

        flashcard("Was ist ein Markt?", 
            "Virtueller oder realer Ort, an dem Angebot und Nachfrage aufeinandertreffen.", "grundlage1")

        flashcard("Welche Akteure gibt es auf einem Markt?", 
            "- Nachfrager\n- Anbieter\n- Vertriebspartner\n- Interessenvertretungen\n- Staatliche Einrichtungen", "grundlage2")

        flashcard("Ziel des Marketings im Markt?", 
            "Verhalten der Kunden und Wettbewerber zum Vorteil des Unternehmens steuern.", "grundlage3")

        quiz_open("Definiere den Begriff 'Markt' im Marketingkontext.", 
            "Ort des Zusammentreffens von Angebot und Nachfrage nach Produkten", "quiz1.1")

        quiz_open("Nenne drei Akteure auf einem Markt.", 
            "Nachfrager, Anbieter, Vertriebspartner", "quiz1.2")

        quiz_mc("Welche Aussagen treffen auf M√§rkte zu?", 
            ["Virtuelle Orte", "Nur Verkaufsplattformen", "Von Akteuren gepr√§gt", "Ort des Wettbewerbs"],
            [0, 2, 3], "mc1.1")

        show_progress()

    # --- CHAPTER 2: Konsumentenverhalten ---
    if chapter == "2. Konsumentenverhalten":
        st.subheader("2. Konsumentenverhalten")

        flashcard("Was ist Konsumentenverhalten?", 
            "Alle beobachtbaren Handlungen von Individuen beim Kauf/Konsum wirtschaftlicher G√ºter.", "kv1")

        flashcard("Nenne zentrale Konstrukte des Konsumentenverhaltens.", 
            "- Aktivierung\n- Motivation\n- Emotionen\n- Involvement\n- Einstellung\n- Kundenzufriedenheit\n- Werte & Lebensstil", "kv2")

        quiz_open("Was bedeutet 'Involvement' im Konsumentenverhalten?", 
            "Zielgerichtete Form der Aktivierung zur Informationsverarbeitung", "quiz2.1")

        quiz_mc("Welche geh√∂ren zu den zentralen Konstrukten des Konsumentenverhaltens?", 
            ["Kundenzufriedenheit", "Einstellung", "Distribution", "Aktivierung"], [0, 1, 3], "mc2.1")

        show_progress()
        
    # --- CHAPTER 3: Organisationales Kaufverhalten ---
    if chapter == "3. Organisationales Kaufverhalten":
        st.subheader("3. Organisationales Kaufverhalten")

        flashcard("Was ist ein Buying Center?", 
            "Gedanklicher Zusammenschluss der an einer organisationalen Kaufentscheidung beteiligten Personen/Gruppen.", "org1")

        flashcard("Nenne typische Rollen im Buying Center.", 
            "- Initiator\n- Benutzer\n- Entscheider\n- Gatekeeper\n- Beeinflusser\n- Eink√§ufer", "org2")

        flashcard("Wichtige Merkmale organisationaler K√§ufe?", 
            "- Hohe Interaktion\n- Langfristigkeit\n- Multipersonalit√§t\n- Hoher Formalisierungsgrad", "org3")

        quiz_open("Welche Rolle hat ein Gatekeeper im Buying Center?", 
            "Filtert oder kontrolliert Informationszugang f√ºr andere Mitglieder", "quiz3.1")

        quiz_mc("Welche Rollen geh√∂ren zum Buying Center?", 
            ["Anwalt", "Initiator", "Entscheider", "Rezeptionist"], [1, 2], "mc3.1")

        show_progress()

    # --- CHAPTER 4: Strategisches Marketing ---
    if chapter == "4. Strategisches Marketing":
        st.subheader("4. Strategisches Marketing")

        flashcard("Was umfasst strategisches Marketing?", 
            "Langfristige, grundlegende Aktivit√§ten wie Analyse, Strategieformulierung und Auswahl marktbezogener Strategien.", "strat1")

        flashcard("Nenne die 3 Zielarten im Marketing.", 
            "- Potenzialbezogene Ziele (z.B. Image, Zufriedenheit)\n- Markterfolgsbezogene Ziele (z.B. Marktanteil)\n- Wirtschaftliche Ziele (z.B. Umsatz)", "strat2")

        flashcard("Prozess der Strategieentwicklung?", 
            "1. Analyse\n2. Strategieformulierung\n3. Bewertung\n4. Auswahl\n5. Umsetzung & Kontrolle", "strat3")

        quiz_open("Was sind potenzialbezogene Ziele im Marketing?", 
            "Ziele wie Image, Bekanntheit, Zufriedenheit", "quiz4.1")

        quiz_mc("Was geh√∂rt zum Strategieentwicklungsprozess?", 
            ["Analyse", "Formulierung", "Werbung", "Kontrolle"], [0, 1, 3], "mc4.1")

        show_progress()

    # --- CHAPTER 5: Digital Marketing ---
    if chapter == "5. Digital Marketing":
        st.subheader("5. Digital Marketing")

        flashcard("Was ist Digital Marketing?", 
            "Technologiegest√ºtzter Prozess zur Schaffung und Erhaltung von Kundennutzen mit digitalen Mitteln.", "dig1")

        flashcard("Nenne 4 Arten digitaler Technologien.", 
            "- Personenbezogene Endger√§te\n- Suchtechnologien\n- Analytische Methoden\n- Konnektivit√§tstechnologien", "dig2")

        flashcard("Was sind unstrukturierte Daten?", 
            "Informationen ohne vordefinierte numerische Ordnung, z.B. Sprache, Gestik, Emotionen.", "dig3")

        quiz_open("Was versteht man unter 'Digitaler Plattform'?", 
            "Digitale Services, die Austausch zwischen Nutzergruppen erm√∂glichen", "quiz5.1")

        quiz_mc("Welche sind Arten digitaler Technologien?", 
            ["Wearables", "Suchtechnologie", "TV-Werbung", "Cloud Computing"], [0, 1, 3], "mc5.1")

        show_progress()
        
    # --- CHAPTER 6: Produktpolitik ---
    if chapter == "6. Produktpolitik":
        st.subheader("6. Produktpolitik")

        flashcard("Was ist Produktpolitik?", 
            "Alle Entscheidungen zur marktgerechten Gestaltung des Produktangebots.", "prod1")

        flashcard("Nenne die drei Produktbegriffe.", 
            "- Substanziell: physisch-technische Eigenschaften\n- Erweitert: Produkt + Dienstleistungen\n- Generisch: Gesamtpaket inkl. Marke, Image", "prod2")

        quiz_open("Was beinhaltet der generische Produktbegriff?", 
            "Materielle und immaterielle Facetten eines Produkts", "quiz6.1")

        quiz_mc("Welche Ziele verfolgt Produktpolitik?", 
            ["Wachstum", "Sicherheit", "Preissteigerung", "Kapazit√§tsauslastung"], [0, 1, 3], "mc6.1")

        show_progress()

    # --- CHAPTER 7: Preispolitik ---
    if chapter == "7. Preispolitik":
        st.subheader("7. Preispolitik")

        flashcard("Was umfasst die Preispolitik?", 
            "Alle Entscheidungen zur Preisgestaltung eines Produkts oder einer Dienstleistung.", "preis1")

        flashcard("Welche Methoden gibt es zur Preisbestimmung?", 
            "- Kostenorientiert\n- Wettbewerbsorientiert\n- Nachfrageorientiert", "preis2")

        quiz_open("Welche drei preisbestimmenden Orientierungen gibt es?", 
            "Kosten-, Wettbewerbs- und Nachfrageorientierung", "quiz7.1")

        show_progress()

    # --- CHAPTER 8: Kommunikationspolitik ---
    if chapter == "8. Kommunikationspolitik":
        st.subheader("8. Kommunikationspolitik")

        flashcard("Ziel der Kommunikationspolitik?", 
            "Beeinflussung von Einstellungen, Wissen, Verhalten der Zielgruppe.", "komm1")

        flashcard("Instrumente der Kommunikation?", 
            "- Werbung\n- Verkaufsf√∂rderung\n- √ñffentlichkeitsarbeit\n- Sponsoring", "komm2")

        quiz_open("Was ist das Ziel der Kommunikationspolitik?", 
            "Einstellung und Verhalten der Zielgruppe beeinflussen", "quiz8.1")

        show_progress()

    # --- CHAPTER 9: Vertriebspolitik ---
    if chapter == "9. Vertriebspolitik":
        st.subheader("9. Vertriebspolitik")

        flashcard("Was ist Vertriebspolitik?", 
            "Alle Entscheidungen zur √úberf√ºhrung des Produkts vom Anbieter zum Kunden.", "vertrieb1")

        flashcard("Nenne zwei Hauptentscheidungen der Vertriebspolitik.", 
            "- Gestaltung des Vertriebssystems\n- Gestaltung der Beziehungen zu Vertriebspartnern", "vertrieb2")

        quiz_open("Was beinhaltet die Gestaltung des Vertriebssystems?", 
            "Entscheidung √ºber Direkt- oder Indirektvertrieb, Mehrkanalstrategien", "quiz9.1")

        show_progress()

    # --- CHAPTER 10: Marktforschung ---
    if chapter == "10. Marktforschung":
        st.subheader("10. Marktforschung")

        flashcard("Ziel der Marktforschung?", 
            "Systematische Sammlung und Auswertung von Informationen √ºber M√§rkte.", "forschung1")

        flashcard("Welche Datenarten gibt es?", 
            "- Prim√§rdaten: selbst erhoben\n- Sekund√§rdaten: bereits vorhanden", "forschung2")

        quiz_open("Was ist der Unterschied zwischen Prim√§r- und Sekund√§rdaten?", 
            "Prim√§rdaten werden neu erhoben, Sekund√§rdaten existieren bereits", "quiz10.1")

        quiz_mc("Welche geh√∂ren zur Prim√§rdatenerhebung?", 
            ["Beobachtung", "Befragung", "Literaturrecherche", "Experiment"], [0, 1, 3], "mc10.1")

        show_progress()
        
    # --- CHAPTER 11: Marktsegmentierung ---
    if chapter == "11. Marktsegmentierung":
        st.subheader("11. Marktsegmentierung")

        flashcard("Was ist Marktsegmentierung?", 
            "Aufteilung des Gesamtmarktes in homogene Teilm√§rkte anhand von K√§ufermerkmalen.", "segm1")

        flashcard("Nenne Segmentierungskriterien.", 
            "- Demographisch\n- Sozio√∂konomisch\n- Nutzenkriterien\n- Kaufverhalten\n- Pers√∂nlichkeitsmerkmale", "segm2")

        quiz_open("Nenne zwei Segmentierungskriterien.", 
            "Demographisch, Sozio√∂konomisch", "quiz11.1")

        show_progress()

    # --- CHAPTER 12: Kundenbeziehungsmanagement ---
    if chapter == "12. Kundenbeziehungsmanagement":
        st.subheader("12. Kundenbeziehungsmanagement")

        flashcard("Ziel des CRM?", 
            "Optimierung und Pflege langfristiger, profitabler Kundenbeziehungen.", "crm1")

        flashcard("Was ist ein Customer Lifetime Value?", 
            "Langfristiger Kundenwert √ºber die gesamte Beziehung hinweg.", "crm2")

        quiz_open("Was ist das Ziel von CRM?", 
            "Langfristige profitable Kundenbeziehungen aufbauen", "quiz12.1")

        show_progress()

    # --- CHAPTER 13: Markenf√ºhrung ---
    if chapter == "13. Markenf√ºhrung":
        st.subheader("13. Markenf√ºhrung")

        flashcard("Was ist eine Marke?", 
            "Ein Name, Begriff, Zeichen oder Symbol zur Identifikation von Produkten.", "marke1")

        flashcard("Ziele der Markenf√ºhrung?", 
            "- Differenzierung\n- Wiedererkennung\n- Kundenbindung\n- Preispremium", "marke2")

        quiz_open("Welche Ziele verfolgt die Markenf√ºhrung?", 
            "Kundenbindung, Differenzierung, Preispremium", "quiz13.1")

        show_progress()

    # --- CHAPTER 14: Innovation & Produktentwicklung ---
    if chapter == "14. Innovationen & Produktentwicklung":
        st.subheader("14. Innovation & Produktentwicklung")

        flashcard("Was ist Produktinnovation?", 
            "Einf√ºhrung eines neuen Produkts oder einer wesentlichen Verbesserung.", "inno1")

        flashcard("Was ist der Stage-Gate-Prozess?", 
            "Phasenmodell zur Entwicklung von Innovationen mit Entscheidungspunkten.", "inno2")

        quiz_open("Wozu dient der Stage-Gate-Prozess?", 
            "Strukturierte Steuerung von Innovationsprojekten", "quiz14.1")

        show_progress()

    # --- CHAPTER 15: Pricing Methoden ---
    if chapter == "15. Pricing Methoden":
        st.subheader("15. Pricing Methoden")

        flashcard("Nenne drei Preisbestimmungsmethoden.", 
            "- Kostenorientiert\n- Wettbewerbsorientiert\n- Nachfrageorientiert", "price1")

        flashcard("Was ist Preisdifferenzierung?", 
            "Verschiedene Preise f√ºr gleiche Leistung, je nach Kundengruppe oder Situation.", "price2")

        quiz_open("Was ist die Idee hinter Nachfrageorientierung beim Pricing?", 
            "Preis wird an Zahlungsbereitschaft der Kunden angepasst", "quiz15.1")

        show_progress()
        
    # --- CHAPTER 16: Preiselastizit√§t ---
    if chapter == "16. Preiselastizit√§t":
        st.subheader("16. Preiselastizit√§t")

        flashcard("Was misst die Preiselastizit√§t?", 
            "Die prozentuale √Ñnderung der Nachfrage bei einer prozentualen Preis√§nderung.", "elas1")

        flashcard("Formel f√ºr Preiselastizit√§t?", 
            "Œµ = (Œîx / x) / (Œîp / p) = (dx(p)/dp) * (p / x(p))", "elas2")

        quiz_open("Was bedeutet eine Elastizit√§t von -2?", 
            "1% Preiserh√∂hung ‚Üí 2% Nachfrager√ºckgang", "quiz16.1")

        show_progress()

    # --- CHAPTER 17: Kommunikationsmix ---
    if chapter == "17. Kommunikationsmix":
        st.subheader("17. Kommunikationsmix")

        flashcard("Was ist ein Kommunikationsmix?", 
            "Kombination verschiedener Kommunikationsinstrumente zur Zielerreichung.", "kommix1")

        flashcard("Nenne vier Instrumente des Kommunikationsmix.", 
            "- Werbung\n- Verkaufsf√∂rderung\n- Sponsoring\n- Public Relations", "kommix2")

        quiz_open("Wozu dient der Kommunikationsmix?", 
            "Gezielte Beeinflussung der Zielgruppe √ºber mehrere Kan√§le", "quiz17.1")

        show_progress()

    # --- CHAPTER 18: Mediaplanung ---
    if chapter == "18. Mediaplanung":
        st.subheader("18. Mediaplanung")

        flashcard("Was ist Mediaplanung?", 
            "Planung der Schaltung von Werbebotschaften √ºber verschiedene Medienkan√§le.", "media1")

        flashcard("Ziele der Mediaplanung?", 
            "- Reichweite maximieren\n- Streuverluste minimieren\n- Zielgruppen passgenau erreichen", "media2")

        quiz_open("Was bedeutet Streuverlust?", 
            "Teil der Zielgruppe wird nicht erreicht oder irrelevante Personen werden angesprochen", "quiz18.1")

        show_progress()

    # --- CHAPTER 19: TKP & Reichweite ---
    if chapter == "19. TKP & Reichweite":
        st.subheader("19. TKP & Reichweite")

        flashcard("Was ist der TKP?", 
            "Tausenderkontaktpreis = Kosten, um 1.000 Personen zu erreichen.", "tkp1")

        flashcard("Formel f√ºr TKP?", 
            "TKP = (Kosten / Bruttoreichweite) * 1.000", "tkp2")

        quiz_open("Worin besteht der Unterschied zwischen Brutto- und Nettoreichweite?", 
            "Brutto = Kontakte, Netto = Personen", "quiz19.1")

        show_progress()

    # --- CHAPTER 20: Sch√§tzfunktionen ---
    if chapter == "20. Sch√§tzfunktionen":
        st.subheader("20. Sch√§tzfunktionen")

        flashcard("Was ist eine Sch√§tzfunktion?", 
            "Statistisches Modell zur Vorhersage einer Zielgr√∂√üe basierend auf unabh√§ngigen Variablen.", "sch√§tz1")

        flashcard("Beurteilung der G√ºte?", 
            "Gute Sch√§tzung: Punkte nahe an der Regressionsgeraden", "sch√§tz2")

        quiz_open("Was sagt die Regressionsgerade in einer Sch√§tzfunktion aus?", 
            "Trendlinie, die den Zusammenhang zwischen zwei Variablen beschreibt", "quiz20.1")

        show_progress()
        
    # --- CHAPTER 21: Buying Center ---
    if chapter == "21. Buying Center":
        st.subheader("21. Buying Center")

        flashcard("Was ist ein Buying Center?", 
            "Zusammenschluss der Personen, die an einer organisationalen Kaufentscheidung beteiligt sind.", "buy1")

        flashcard("Rollen im Buying Center?", 
            "- Initiator\n- Benutzer\n- Entscheider\n- Gatekeeper\n- Beeinflusser\n- Eink√§ufer", "buy2")

        quiz_open("Welche Rolle hat der 'Entscheider' im Buying Center?", 
            "Trifft letztlich die Kaufentscheidung", "quiz21.1")

        show_progress()

    # --- CHAPTER 22: Erfahrungskurve ---
    if chapter == "22. Erfahrungskurve":
        st.subheader("22. Erfahrungskurve")

        flashcard("Was besagt die Erfahrungskurve?", 
            "Mit jeder Verdopplung der kumulierten Produktionsmenge sinken die St√ºckkosten um 20‚Äì30%.", "exp1")

        flashcard("Formel der Erfahrungskurve?", 
            "k(x) = a * x^(-b)", "exp2")

        quiz_open("Was sagt das Erfahrungskurvenmodell √ºber die Kostenentwicklung?", 
            "St√ºckkosten sinken mit zunehmender Produktionserfahrung", "quiz22.1")

        show_progress()

    # --- CHAPTER 23: Lebenszyklusmodell ---
    if chapter == "23. Lebenszyklusmodell":
        st.subheader("23. Lebenszyklusmodell")

        flashcard("Phasen des Produktlebenszyklus?", 
            "- Einf√ºhrung\n- Wachstum\n- Reife\n- S√§ttigung\n- Degeneration", "life1")

        flashcard("Ziel des Modells?", 
            "Planung & Steuerung von Marketingaktivit√§ten je nach Produktphase.", "life2")

        quiz_open("Welche Phase folgt auf die Reifephase im Produktlebenszyklus?", 
            "S√§ttigung", "quiz23.1")

        show_progress()

    # --- CHAPTER 24: Ansoff & Wettbewerbsstrategien ---
    if chapter == "24. Ansoff Matrix & Wettbewerbsstrategien":
        st.subheader("24. Ansoff & Wettbewerbsstrategien")

        flashcard("Vier Felder der Ansoff-Matrix?", 
            "- Marktdurchdringung\n- Marktentwicklung\n- Produktentwicklung\n- Diversifikation", "ans1")

        flashcard("Nenne Wettbewerbsstrategien nach Porter.", 
            "- Kostenf√ºhrerschaft\n- Differenzierung\n- Nischenstrategie", "ans2")

        quiz_open("Was ist das Ziel der Kostenf√ºhrerschaft?", 
            "Wettbewerbsvorteil durch niedrige Kosten", "quiz24.1")

        show_progress()

# --- PAST EXAM MODE ---
elif section == "üìù Past Exam Training":
    st.header(f"{exam_icon} Past Exam Trainer")

    exam = st.selectbox("Choose Exam", ["SS23", "SoSe23 (Mock)", "SS25"])

    st.info("All questions are interactive. Open-ended answers will be evaluated manually.")

    def exam_flashcard(q, a, key):
        with st.expander(f"{quiz} {q}"):
            st.markdown(f"{brain} **Solution:** {a}")

    def exam_open(q, model_answer, key):
        user = st.text_area(f"{quiz} {q}", key=key)
        if user:
            st.markdown(f"{brain} **Model Answer:** {model_answer}")

    # --- SS23 EXAM ---
    if exam == "SS23":
        st.subheader("SS23 Exam Questions")

        exam_open("Erkl√§re das Informations-Likelihood-Modell.", 
                  "Modell zur Analyse von Informationsverarbeitung & Entscheidungsfindung. Zwei Wege: zentrale (logische) und periphere (emotionale) Verarbeitung.", "ss23_q1")

        exam_open("Was ist ein Buying Center? Nenne 3 Rollen.", 
                  "Gedanklicher Zusammenschluss mehrerer Beteiligter im B2B-Kaufprozess. Rollen: Initiator, Entscheider, Gatekeeper, Benutzer, Eink√§ufer, Beeinflusser.", "ss23_q2")

        exam_open("Nenne 2 Konstrukte des Konsumentenverhaltens & erl√§utere eines am Beispiel 'Kauf eines Tablets'.", 
                  "Z.B. Involvement ‚Äì bei Kauf eines Tablets erfolgt aktiver Vergleich verschiedener Modelle & Marken.", "ss23_q3")

        exam_open("Nenne 3 zentrale Arten digitaler Technologien und deren Fokus.", 
                  "- Wearables: personenbezogen\n- Cloud: Analyse\n- IoT: Konnektivit√§t", "ss23_q4")

        exam_open("Berechne relative Wichtigkeit Griffmaterial (Conjoint).", 
                  "Wichtigkeit = Range Griffmaterial / Summe aller Ranges (Details aus Tabelle)", "ss23_q5")

        exam_open("Ermittle lineare PAF f√ºr Oral-D (gegeben: 2 Preis/Absatzpaare).", 
                  "p1=75‚Ç¨, x1=100k; p2=55‚Ç¨, x2=140k ‚áí PAF = x(p) = a - b*p (Rechnung einsetzen)", "ss23_q6")

        exam_open("Was ist der Vertriebsansatz 'Restaurant-Kooperation' bei 'plants4meat'?", 
                  "Indirekter Vertrieb via Kooperationspartner mit gezieltem Imagetransfer (Pull-Effekt).", "ss23_q7")

        exam_open("Nenne 2 Gestaltungsfehler in Werbekampagnen.", 
                  "Z.B. zu komplexe Botschaft, unpassender Zeitpunkt", "ss23_q7b")

        exam_open("Berechne Sch√§tzfunktion & Absatz bei 30 Probefahrten.", 
                  "Verwende lineare Regression mit ‚àëxi*yi, n=5, Formeln aus Klausur", "ss23_q8")

    # --- SoSe23 MOCK EXAM ---
    if exam == "SoSe23 (Mock)":
        st.subheader("Mock Exam SoSe23")

        exam_open("Nenne 4 Konstrukte des Konsumentenverhaltens & erkl√§re sie in einem Satz.", 
                  "- Aktivierung: Erregung\n- Motivation: Zielgerichtete Aktivierung\n- Emotion: Gef√ºhl\n- Involvement: Intensit√§t der Informationsverarbeitung", "mock_q1")

        exam_open("Ordne Sucheigenschaften passende Strategien zu.", 
                  "- Sucheigenschaften = Inspektion\n- Erfahrung = Substitution durch Marke/Garantie\n- Vertrauen = Reputationssubstitution", "mock_q2")

        exam_open("Berechne St√ºckkosten mit Erfahrungskurve.", 
                  "Formel: k(x) = a * x^(-b), Daten aus Tabelle verwenden", "mock_q3")

        exam_open("Zeichne 4 Plattformtypen in 2D-Matrix (Vermittlung x Konsozialit√§t).", 
                  "Achsen: Vermittlung (niedrig‚Äìhoch), Konsozialit√§t (niedrig‚Äìhoch) ‚Üí Eintragen: Enabler, Hub, Matchmaker, Forum", "mock_q4")

        exam_open("Berechne Preiselastizit√§t f√ºr Smart-Set bei 20‚Ç¨.", 
                  "PAF: x(p)=18.000e^-0.4p ‚áí E(p)=dx/dp * p/x(p) = -0.4*20 = -8", "mock_q5")

        exam_open("Gewinnmaximaler Preis f√ºr Franken Limo.", 
                  "G(p) = p*x(p) - K(x) ‚áí Ableiten, Nullsetzen ‚áí p = 0.78", "mock_q6")

        exam_open("Definiere Nettoreichweite. Unterschied zur Bruttoreichweite?", 
                  "Netto = Personen, Brutto = Kontakte", "mock_q7")

        exam_open("Berechne Bruttoreichweite aus Tabelle.", 
                  "4√ó5.1 + 3√ó3.6 + 6√ó2.4 = 45.6 Mio", "mock_q7b")

        exam_open("Nenne 2 Kriterien f√ºr Key Account Auswahl + Begr√ºndung.", 
                  "z.B. wirtschaftliches Potenzial, Know-How ‚Üí Imagetransfer, Innovationskraft", "mock_q8")

        exam_open("Prim√§r- vs. Sekund√§rdaten bei Onlineshop-Redesign?", 
                  "Zufriedenheit = Befragung = Prim√§rdaten; Layout = A/B-Test = Prim√§rdaten", "mock_q9")

        exam_open("Beurteile Sch√§tzfunktion (Grafik: Punkte weit von Gerade entfernt).", 
                  "Keine hohe G√ºte, da Streuung gro√ü", "mock_q9b")
                
    # --- SS25 EXAM ---
    if exam == "SS25":
        st.subheader("SS25 Exam Questions")

        exam_open("Erkl√§re Elaboration und zeichne Elaboration Likelihood Modell.", 
                  "Elaboration = Ausma√ü kognitiver Informationsverarbeitung. Zwei Wege: zentral (stark elaboriert) vs. peripher (oberfl√§chlich).", "ss25_q1")

        exam_open("Definiere Buying Center + nenne 3 Rollen.", 
                  "Beteiligte Personen an einer B2B-Kaufentscheidung. Rollen: Initiator, Benutzer, Entscheider, Eink√§ufer, Gatekeeper, Beeinflusser.", "ss25_q2")

        exam_open("Schritte der Strategieentwicklung + Beispiel.", 
                  "1. Analyse\n2. Strategieformulierung\n3. Bewertung\n4. Auswahl\n5. Umsetzung\nBeispiel: Fahrradhersteller-Marktanalyse ‚Üí Diversifikation ‚Üí Bewertung ‚Üí Umsetzung", "ss25_q3")

        exam_open("Zeichne die 4 Plattformtypen (Achsen + Einordnung).", 
                  "Achsen: Vermittlungsgrad & Konsozialit√§t. Eintragen: Enabler, Hub, Matchmaker, Forum", "ss25_q4")

        exam_open("Berechne Preiselastizit√§t bei p=20 (x(p) = 1000 ‚Äì 40p).", 
                  "dx/dp = -40, x(20)=200 ‚áí E = -40 * 20 / 200 = -4", "ss25_q5")

        exam_open("Gewinnmaximaler Preis f√ºr Franken Limo (PAF + Kostenfunktion gegeben).", 
                  "G(p) ableiten ‚áí f'(p)=0 ‚áí p=0.78", "ss25_q6")

        exam_open("Definiere Nettoreichweite. Unterschied zu Bruttoreichweite?", 
                  "Netto = Personen, Brutto = Kontakte", "ss25_q7")

        exam_open("Bruttoreichweite berechnen (Tabelle).", 
                  "4√ó5.1 + 3√ó3.6 + 6√ó2.4 = 45.6 Mio", "ss25_q7b")

        exam_open("Nenne 2 Kriterien zur Auswahl von Vertriebspartnern + 2 f√ºr Key Account Auswahl mit Begr√ºndung.", 
                  "z.B. Image, wirtschaftliche Bedeutung ‚Üí Imagetransfer, Know-how", "ss25_q8")

        exam_open("Nenne passende Datenerhebungen f√ºr 2 Fragestellungen + Klassifizierung (Prim√§r-/Sekund√§rdaten).", 
                  "Zufriedenheit = Befragung (Prim√§r)\nLayoutoptimierung = A/B-Test (Prim√§r)", "ss25_q9")

        exam_open("Beurteile Sch√§tzfunktion aus gezeigter Grafik.", 
                  "Punkte liegen weit von Regressionsgerade entfernt ‚Üí geringe G√ºte", "ss25_q9b")

# --- PROGRESS TRACKER ---
elif section == "üìä Progress Tracker":
    st.header(f"{chart} Progress Overview")

    total_attempts = st.session_state.correct + st.session_state.incorrect
    if total_attempts > 0:
        st.metric("‚úÖ Correct Answers", st.session_state.correct)
        st.metric("‚ùå Incorrect Answers", st.session_state.incorrect)
        st.metric("üìä Accuracy", f"{(st.session_state.correct / total_attempts) * 100:.1f}%")
        st.progress(st.session_state.correct / total_attempts)
    else:
        st.info("You haven‚Äôt answered any questions yet.")

    if st.button("üîÑ Reset Progress"):
        reset_progress()
        st.success("Progress has been reset.")

# --- END OF FILE ---
    # --- BONUS: Vertiefung f√ºr 1.0 ---
    if chapter == "Vertiefung f√ºr 1.0":
        st.subheader("üìà Vertiefung f√ºr 1.0")

        flashcard("Stelle die PAF x(p) = 100 - 2p nach p um.", 
                  "p(x) = (100 - x) / 2", "v1")

        quiz_open("Wie ver√§ndert sich die Nachfrage bei +10% Preis√§nderung (PAF: x(p) = 100 - 2p)?", 
                  "Nachfrage sinkt z.‚ÄØB. von 60 auf 56 bei Preisanstieg von 20‚ÄØ‚Ç¨ auf 22‚ÄØ‚Ç¨", "v2")

        flashcard("Erkl√§re das AIDA-Modell.", 
                  "A = Attention\nI = Interest\nD = Desire\nA = Action\n‚Üí Klassisches Modell zur Werbewirkung", "v3")

        quiz_open("Nenne ein reales Beispiel f√ºr AIDA (z.‚ÄØB. Apple-Werbung).", 
                  "iPhone: Aufmerksamkeit durch Bild, Interesse durch Headline, Wunsch durch Features, Aktion durch Call-to-Action", "v4")

        flashcard("Gruppe A: √ò=4,5 | Var=0,2 ‚Äî Gruppe B: √ò=4,2 | Var=0,05. Welche Kampagne ist besser?", 
                  "A = h√∂here Wirkung, B = stabilere Wirkung ‚Üí h√§ngt vom Ziel ab", "v5")

        flashcard("Unterscheide vollkommener Markt vs. Monopol (grafisch & strategisch).", 
                  "- Vollkommener Markt: horizontale Nachfrage, kein Preisspielraum\n- Monopol: fallende Nachfrage, Preisgestaltung m√∂glich", "v6")

        quiz_open("Bewerte die Strategie 'Restaurant-Kooperation' bei plants4meat.", 
                  "Indirekter Vertrieb, Imagetransfer, glaubw√ºrdige Platzierung, aber Kontrollverlust m√∂glich", "v7")

        show_progress()
